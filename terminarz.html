<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puchar Gwiazd | Terminarz</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="logo.png">

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">

    <style>
        /* --- NAVBAR FIX (Menu Mobilne) --- */
        .navbar {
            position: sticky; top: 0; z-index: 999999;
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 5%; background: rgba(15, 23, 42, 0.98);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .brand { display: flex; align-items: center; gap: 10px; text-decoration: none; color: #fff; font-weight: 800; }
        .logo-img { height: 40px; }
        .menu-toggle { display: none; font-size: 2rem; color: #fff; cursor: pointer; padding: 10px; user-select: none; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        
        @media (max-width: 900px) {
            .menu-toggle { display: block; }
            .nav-links { 
                display: none; 
                position: absolute; top: 100%; left: 0; width: 100%; 
                background: #0f172a; flex-direction: column; padding: 20px 0; 
                border-bottom: 1px solid rgba(255,255,255,0.2); 
                box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            }
            .nav-links.active { display: flex !important; }
            .nav-links a { 
                padding: 15px; width: 100%; text-align: center; 
                border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 1.2rem; 
            }
        }

        /* --- STYLE DLA TERMINARZA --- */
        .group-card {
            background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px; margin-bottom: 20px; overflow: hidden;
            transition: 0.3s;
        }
        .group-header {
            padding: 20px; background: rgba(255,255,255,0.03);
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; font-weight: 800; font-size: 1.1rem;
        }
        .group-header:hover { background: rgba(255,255,255,0.06); color: #00d4ff; }
        
        .group-content { display: none; padding: 0; animation: fadeIn 0.3s; }
        .group-content.active { display: block; }

        .match-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .match-row:last-child { border-bottom: none; }
        
        .match-date { font-size: 0.8rem; color: #888; width: 80px; }
        .match-teams { flex: 1; text-align: center; font-weight: 600; display: flex; justify-content: center; gap: 15px; }
        .match-score { color: #00d4ff; font-weight: 800; min-width: 40px; text-align: center; }

        @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }

        .tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 40px; }
        .tab-btn {
            background: transparent; border: 1px solid rgba(255,255,255,0.2);
            color: #ccc; padding: 10px 25px; border-radius: 30px; cursor: pointer;
            font-weight: 700; transition: 0.3s;
        }
        .tab-btn.active, .tab-btn:hover {
            background: #00d4ff; color: #000; border-color: #00d4ff;
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <a href="index.html" class="brand">
            <img src="logo.png" alt="Logo" class="logo-img">
            <span class="logo-text">PUCHAR GWIAZD</span>
        </a>

        <div class="menu-toggle" onclick="toggleMenu()">
            <i class="fas fa-bars"></i>
        </div>

        <div class="nav-links" id="navLinks">
            <a href="index.html">STRONA GŁÓWNA</a>
            <a href="druzyny.html">DRUŻYNY</a>
            <a href="terminarz.html" class="active-link" style="color:#00d4ff;">TERMINARZ</a>
            <a href="tabela.html">TABELE</a>
            <a href="regulamin.html">REGULAMIN</a>
            <a href="onas.html">O NAS</a>
            <a href="login_kapitana.html" class="admin-btn">KAPITAN</a>
            <a href="admin.html" class="admin-btn" style="background: rgba(255, 77, 77, 0.15); border-color: var(--danger);">ADMIN</a>
        </div>
    </nav>

    <script>
        function toggleMenu() {
            var nav = document.getElementById("navLinks");
            if (nav.style.display === "flex") {
                nav.style.display = "";
                nav.classList.remove("active");
            } else {
                nav.classList.toggle("active");
            }
        }
    </script>

    <main class="container">
        <header class="page-header" data-aos="fade-down" style="text-align:center; margin: 50px 0 30px;">
            <h2 style="font-size:2rem; font-weight:800; margin:0;">TERMINARZ</h2>
            <p style="color:#00d4ff; letter-spacing:2px; font-size:0.9rem; font-weight:700;">HARMONOGRAM GRY</p>
        </header>

        <div class="tabs" data-aos="fade-up">
            <button class="tab-btn active" onclick="showStage('group')">FAZA GRUPOWA</button>
            <button class="tab-btn" onclick="showStage('knockout')">FAZA PUCHAROWA</button>
        </div>

        <div id="group-stage-view">
            <div class="group-card" id="card-a" data-aos="fade-up">
                <div class="group-header" onclick="toggleGroup('a')">
                    <span>GRUPA A</span>
                    <i class="fas fa-chevron-down" style="transition:0.3s"></i>
                </div>
                <div id="list-group-a" class="group-content">Wczytywanie...</div>
            </div>

            <div class="group-card" id="card-b" data-aos="fade-up" data-aos-delay="100">
                <div class="group-header" onclick="toggleGroup('b')">
                    <span>GRUPA B</span>
                    <i class="fas fa-chevron-down" style="transition:0.3s"></i>
                </div>
                <div id="list-group-b" class="group-content">Wczytywanie...</div>
            </div>

            <div class="group-card" id="card-c" data-aos="fade-up" data-aos-delay="200">
                <div class="group-header" onclick="toggleGroup('c')">
                    <span>GRUPA C</span>
                    <i class="fas fa-chevron-down" style="transition:0.3s"></i>
                </div>
                <div id="list-group-c" class="group-content">Wczytywanie...</div>
            </div>

            <div class="group-card" id="card-d" data-aos="fade-up" data-aos-delay="300">
                <div class="group-header" onclick="toggleGroup('d')">
                    <span>GRUPA D</span>
                    <i class="fas fa-chevron-down" style="transition:0.3s"></i>
                </div>
                <div id="list-group-d" class="group-content">Wczytywanie...</div>
            </div>
        </div>

        <div id="knockout-stage-view" style="display: none;">
            <div class="group-card" style="border-color: var(--primary);">
                <div class="group-header" style="cursor: default; background: rgba(0, 85, 255, 0.1);">
                    <span>DRABINKA TURNIEJOWA</span>
                    <i class="fas fa-trophy" style="color: gold;"></i>
                </div>
                <div id="knockout-list" style="padding: 20px;">Wczytywanie...</div>
            </div>
        </div>

    </main>

    <footer style="text-align:center; padding: 60px; opacity: 0.4; font-size: 0.8rem; margin-top:50px; border-top: 1px solid rgba(255,255,255,0.1);">
        &copy; 2025 PUCHAR GWIAZD
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script> AOS.init({ duration: 600, once: true }); </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const CONFIG = { apiKey: "AIzaSyC6r04aG6T5EYqJ4OClraYU5Jr34ffONwo", authDomain: "puchargwiazd-bdaa4.firebaseapp.com", projectId: "puchargwiazd-bdaa4", storageBucket: "puchargwiazd-bdaa4.firebasestorage.app", messagingSenderId: "890734185883", appId: "1:890734185883:web:75e8df76127397b913612d" };
        const app = initializeApp(CONFIG);
        const db = getFirestore(app);

        // --- POBIERANIE MECZÓW ---
        const q = query(collection(db, "matches"), orderBy("date"), orderBy("time"));

        onSnapshot(q, (snap) => {
            const groups = { a: [], b: [], c: [], d: [], knockout: [] };

            snap.forEach(doc => {
                const m = doc.data();
                const type = m.group ? m.group.toLowerCase() : 'knockout';
                
                if(['a','b','c','d'].includes(type)) {
                    groups[type].push(m);
                } else {
                    groups.knockout.push(m);
                }
            });

            // Renderuj Grupy
            ['a','b','c','d'].forEach(g => {
                const container = document.getElementById(`list-group-${g}`);
                if(!container) return;
                
                if(groups[g].length === 0) {
                    container.innerHTML = '<div style="padding:15px; text-align:center; color:#666;">Brak meczów.</div>';
                } else {
                    let html = '';
                    groups[g].forEach(m => {
                        html += `
                            <div class="match-row">
                                <div class="match-date">
                                    ${m.date}<br><span style="color:#555">${m.time}</span>
                                </div>
                                <div class="match-teams">
                                    <span>${m.team1}</span>
                                    <span class="match-score">${m.score1} : ${m.score2}</span>
                                    <span>${m.team2}</span>
                                </div>
                            </div>
                        `;
                    });
                    container.innerHTML = html;
                }
            });

            // Renderuj Pucharową
            const kContainer = document.getElementById('knockout-list');
            if(groups.knockout.length === 0) {
                kContainer.innerHTML = '<p style="text-align:center; opacity:0.5;">Faza pucharowa jeszcze się nie rozpoczęła.</p>';
            } else {
                let html = '';
                groups.knockout.forEach(m => {
                    html += `
                        <div class="match-row">
                            <div class="match-date">
                                <b>${m.group || 'Mecz'}</b><br>${m.date} | ${m.time}
                            </div>
                            <div class="match-teams">
                                <span>${m.team1}</span>
                                <span class="match-score">${m.score1} : ${m.score2}</span>
                                <span>${m.team2}</span>
                            </div>
                        </div>
                    `;
                });
                kContainer.innerHTML = html;
            }
        });

        // --- FUNKCJE WIDOKU ---
        window.toggleGroup = function(group) {
            const content = document.getElementById(`list-group-${group}`);
            const icon = document.querySelector(`#card-${group} .fa-chevron-down`);
            
            if(content.classList.contains('active')) {
                content.classList.remove('active');
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('active');
                icon.style.transform = 'rotate(180deg)';
            }
        };

        window.showStage = function(stage) {
            const btns = document.querySelectorAll('.tab-btn');
            btns.forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');

            if(stage === 'group') {
                document.getElementById('group-stage-view').style.display = 'block';
                document.getElementById('knockout-stage-view').style.display = 'none';
            } else {
                document.getElementById('group-stage-view').style.display = 'none';
                document.getElementById('knockout-stage-view').style.display = 'block';
            }
        };
    </script>

</body>
</html>
