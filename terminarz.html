<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminarz | Puchar Gwiazd</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="logo.png">

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">

    <style>
        /* STYLE TYLKO DLA ELEMENTÓW GENEROWANYCH PRZEZ JS */
        
        .match-row {
            display: grid; 
            grid-template-columns: 1fr auto 1fr; 
            gap: 15px; 
            align-items: center;
            padding: 15px; 
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: 0.2s;
        }
        .match-row:last-child { border-bottom: none; }
        .match-row:hover { background: rgba(255,255,255,0.03); }

        .team-left { text-align: right; font-weight: 600; color: #fff; }
        .team-right { text-align: left; font-weight: 600; color: #fff; }
        
        .score-badge {
            background: rgba(0,0,0,0.4); 
            padding: 5px 15px; 
            border-radius: 8px;
            font-weight: 800; 
            color: #00d4ff; 
            min-width: 60px; 
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        /* Status Live */
        .match-live .score-badge { color: #ff4d4d; border-color: #ff4d4d; animation: pulse 2s infinite; }
        
        /* Ukrywanie/Pokazywanie grup */
        .group-content { display: none; }
        .group-content.active { display: block; animation: fadeIn 0.3s ease; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    </style>
</head>
<body>

    <nav class="navbar">
        <a href="index.html" class="logo" style="text-decoration: none; display: flex; align-items: center; color: inherit;">
            <img src="logo.png" alt="Logo" style="height: 40px; margin-right: 10px; vertical-align: middle;">
            PUCHAR GWIAZD
        </a>
        
        <div class="nav-links">
            <a href="index.html">Start</a>
	        <a href="druzyny.html">Drużyny</a>
            <a href="terminarz.html" class="active">Terminarz</a>
            <a href="tabela.html">Tabele</a>
 	        <a href="regulamin.html">Regulamin</a>
 	        <a href="onas.html">O nas</a>
            <a href="login_kapitana.html" class="admin-btn">KAPITAN</a>
            <a href="admin.html" class="admin-btn" style="background: rgba(255, 77, 77, 0.15); border-color: var(--danger);">ADMIN</a>
        </div>
    </nav>

    <div class="container" style="max-width: 900px; margin: 40px auto; padding: 0 20px;">
        
        <div style="text-align: center; margin-bottom: 30px;" data-aos="fade-down">
            <h1>TERMINARZ</h1>
        </div>

        <div class="tabs" style="display:flex; justify-content:center; gap:15px; margin-bottom:30px;" data-aos="fade-up">
            <button class="btn" onclick="showStage('group', this)" style="background:#00d4ff; color:#000; border:none; padding:10px 20px; border-radius:20px; font-weight:bold; cursor:pointer;">Faza Grupowa</button>
            <button class="btn" onclick="showStage('knockout', this)" style="background:rgba(255,255,255,0.1); color:#fff; border:1px solid #444; padding:10px 20px; border-radius:20px; font-weight:bold; cursor:pointer;">Faza Pucharowa</button>
        </div>

        <div id="group-stage-view">
            
            <div class="card" id="card-A" style="background:rgba(20, 30, 50, 0.8); border:1px solid #333; border-radius:15px; margin-bottom:20px; overflow:hidden;" data-aos="fade-up">
                <div onclick="toggleGroup('A')" style="padding:20px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.05);">
                    <h3 style="margin:0; color:#00d4ff;">GRUPA A</h3> <i class="fas fa-chevron-down"></i>
                </div>
                <div class="group-content active" id="list-group-A">
                    <div style="padding:20px; text-align:center; color:#888;">Ładowanie meczów...</div>
                </div>
            </div>

            <div class="card" id="card-B" style="background:rgba(20, 30, 50, 0.8); border:1px solid #333; border-radius:15px; margin-bottom:20px; overflow:hidden;" data-aos="fade-up">
                <div onclick="toggleGroup('B')" style="padding:20px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.05);">
                    <h3 style="margin:0; color:#00d4ff;">GRUPA B</h3> <i class="fas fa-chevron-down"></i>
                </div>
                <div class="group-content active" id="list-group-B">
                    <div style="padding:20px; text-align:center; color:#888;">Ładowanie meczów...</div>
                </div>
            </div>

            <div class="card" id="card-C" style="background:rgba(20, 30, 50, 0.8); border:1px solid #333; border-radius:15px; margin-bottom:20px; overflow:hidden;" data-aos="fade-up">
                <div onclick="toggleGroup('C')" style="padding:20px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.05);">
                    <h3 style="margin:0; color:#00d4ff;">GRUPA C</h3> <i class="fas fa-chevron-down"></i>
                </div>
                <div class="group-content active" id="list-group-C">
                    <div style="padding:20px; text-align:center; color:#888;">Ładowanie meczów...</div>
                </div>
            </div>

            <div class="card" id="card-D" style="background:rgba(20, 30, 50, 0.8); border:1px solid #333; border-radius:15px; margin-bottom:20px; overflow:hidden;" data-aos="fade-up">
                <div onclick="toggleGroup('D')" style="padding:20px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,0.05);">
                    <h3 style="margin:0; color:#00d4ff;">GRUPA D</h3> <i class="fas fa-chevron-down"></i>
                </div>
                <div class="group-content active" id="list-group-D">
                    <div style="padding:20px; text-align:center; color:#888;">Ładowanie meczów...</div>
                </div>
            </div>

        </div>

        <div id="knockout-stage-view" style="display:none;">
            <div class="card" style="background:rgba(20, 30, 50, 0.8); border:1px solid #333; border-radius:15px;" data-aos="fade-up">
                <div style="padding:20px; border-bottom:1px solid #333; color:gold;">
                    <h3 style="margin:0;"><i class="fas fa-trophy"></i> FINAŁY</h3>
                </div>
                <div class="group-content active" id="list-faza_pucharowa">
                    <div style="padding:20px; text-align:center; color:#888;">Brak meczów</div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script> AOS.init(); </script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyC6r04aG6T5EYqJ4OClraYU5Jr34ffONwo",
            authDomain: "puchargwiazd-bdaa4.firebaseapp.com",
            projectId: "puchargwiazd-bdaa4",
            storageBucket: "puchargwiazd-bdaa4.firebasestorage.app",
            messagingSenderId: "890734185883",
            appId: "1:890734185883:web:75e8df76127397b913612d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // POBIERANIE MECZÓW
        db.collection('matches').orderBy('date', 'asc').onSnapshot(snap => {
            const containers = {
                'A': document.getElementById('list-group-A'),
                'B': document.getElementById('list-group-B'),
                'C': document.getElementById('list-group-C'),
                'D': document.getElementById('list-group-D'),
                'faza_pucharowa': document.getElementById('list-faza_pucharowa')
            };

            // Czyścimy widok
            for(let k in containers) if(containers[k]) containers[k].innerHTML = '';

            const matches = [];
            snap.forEach(doc => matches.push(doc.data()));

            // Sortowanie: Data, potem Godzina
            matches.sort((a,b) => {
                if(a.date !== b.date) return a.date.localeCompare(b.date);
                return (a.time || '').localeCompare(b.time || '');
            });

            matches.forEach(m => {
                const gr = m.group || 'A';
                let score = m.time || '-:-';
                let rowClass = '';

                if(m.status === 'live') {
                    score = `${m.homeScore}:${m.awayScore}`;
                    rowClass = 'match-live';
                } else if(m.status === 'finished') {
                    score = `${m.homeScore}:${m.awayScore}`;
                }

                // TWORZENIE ELEMENTU MECZU
                const html = `
                    <div class="match-row ${rowClass}">
                        <div class="team-left">${m.home}</div>
                        <div style="text-align:center;">
                            <div class="score-badge">${score}</div>
                            <div style="font-size:0.7rem; color:#888; margin-top:3px;">${m.date}</div>
                        </div>
                        <div class="team-right">${m.away}</div>
                    </div>
                `;

                if(containers[gr]) containers[gr].innerHTML += html;
            });

            // Komunikat o braku meczów
            for(let k in containers) {
                if(containers[k] && containers[k].innerHTML === '') {
                    containers[k].innerHTML = '<div style="padding:20px; text-align:center; color:#666;">Brak zaplanowanych meczów</div>';
                }
            }
        });

        // NAWIGACJA
        window.toggleGroup = function(g) {
            const el = document.getElementById(`list-group-${g}`);
            const icon = document.querySelector(`#card-${g} .fa-chevron-down`);
            if(el.classList.contains('active')) {
                el.classList.remove('active');
                if(icon) icon.style.transform = 'rotate(0deg)';
            } else {
                el.classList.add('active');
                if(icon) icon.style.transform = 'rotate(180deg)';
            }
        };

        window.showStage = function(stage, btn) {
            // Zmiana kolorów guzików
            const btns = document.querySelectorAll('.tabs button');
            btns.forEach(b => {
                b.style.background = 'rgba(255,255,255,0.1)';
                b.style.color = '#fff';
            });
            btn.style.background = '#00d4ff';
            btn.style.color = '#000';

            if(stage === 'group') {
                document.getElementById('group-stage-view').style.display = 'block';
                document.getElementById('knockout-stage-view').style.display = 'none';
            } else {
                document.getElementById('group-stage-view').style.display = 'none';
                document.getElementById('knockout-stage-view').style.display = 'block';
            }
        };
    </script>
</body>
</html>