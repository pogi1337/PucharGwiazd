<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admina - Puchar Gwiazd</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-body: #090f1f;
            --sidebar-bg: #111827;
            --modal-bg: #1f2937;
            --accent: #38bdf8;
            --primary: #3b82f6;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text-main: #f3f4f6;
            --border: rgba(255,255,255,0.1);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0; display: flex; height: 100vh; overflow: hidden;
        }

        * { box-sizing: border-box; scrollbar-width: thin; }

        /* SIDEBAR */
        .sidebar {
            width: 260px; background: var(--sidebar-bg); border-right: 1px solid var(--border);
            display: flex; flex-direction: column; padding: 20px; flex-shrink: 0;
        }
        .logo { font-size: 1.4rem; font-weight: 800; margin-bottom: 40px; color: var(--accent); display:flex; gap:10px; align-items:center; }
        .menu-btn {
            background: none; border: none; color: #9ca3af; padding: 15px; text-align: left; cursor: pointer;
            font-size: 1rem; border-radius: 8px; transition: 0.2s; margin-bottom: 5px; font-weight: 600; display:flex; gap:10px; align-items:center;
        }
        .menu-btn:hover { background: rgba(255,255,255,0.05); color: white; }
        .menu-btn.active { background: rgba(56, 189, 248, 0.1); color: var(--accent); }

        /* MAIN CONTENT */
        .main { flex-grow: 1; padding: 30px; overflow-y: auto; position: relative; }
        .section { display: none; }
        .section.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

        /* UI ELEMENTS */
        .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .card { background: #1e293b; padding: 20px; border-radius: 12px; border: 1px solid var(--border); margin-bottom: 20px; }
        
        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; transition:0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: #4b5563; color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-success { background: var(--success); color: #000; }
        .btn-sm { padding: 6px 12px; font-size: 0.85rem; }

        .match-card {
            background: #1e293b; border: 1px solid var(--border); border-radius: 12px;
            padding: 15px 20px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between;
        }

        /* TABLES GRID */
        .tables-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; }
        
        .styled-table { width: 100%; border-collapse: collapse; margin-top: 10px; color: #ddd; font-size: 0.9rem; }
        .styled-table th { text-align: center; padding: 10px; background: rgba(0,0,0,0.3); border-bottom: 2px solid var(--border); color: var(--accent); }
        .styled-table td { padding: 10px; border-bottom: 1px solid var(--border); text-align: center; }
        .styled-table td:nth-child(2) { text-align: left; font-weight: 600; color: white; } /* Nazwa drużyny do lewej */

        /* MODALS */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px);
            z-index: 1000; display: none; justify-content: center; align-items: center;
        }
        .modal-overlay.open { display: flex; }
        .modal-box {
            background: var(--modal-bg); width: 95%; max-width: 700px; max-height: 90vh;
            border-radius: 20px; border: 1px solid var(--border);
            display: flex; flex-direction: column; overflow: hidden;
        }
        .modal-header { padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2); }
        .modal-body { padding: 25px; overflow-y: auto; }
        .modal-footer { padding: 20px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 10px; background: rgba(0,0,0,0.2); }
        
        .grid-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }
        input, select, textarea { width: 100%; padding: 12px; background: #374151; border: 1px solid var(--border); color: white; border-radius: 8px; margin-top: 5px; }

        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #050a18; z-index: 2000; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="login-screen">
    <div style="background: #1f2937; padding: 40px; border-radius: 20px; width: 100%; max-width: 400px; text-align: center;">
        <h2 style="color:var(--accent);">ADMIN PANEL</h2>
        <input type="email" id="login-email" placeholder="Email">
        <input type="password" id="login-password" placeholder="Hasło" style="margin-bottom:20px;">
        <button class="btn btn-primary" onclick="login()" style="width:100%">ZALOGUJ</button>
    </div>
</div>

<div id="app-container" style="display:none; width:100%; height:100%;">
    <nav class="sidebar">
        <div class="logo"><i class="fas fa-crown"></i> PUCHAR GWIAZD</div>
        <button class="menu-btn active" onclick="switchTab('matches', this)"><i class="fas fa-futbol"></i> Mecze</button>
        <button class="menu-btn" onclick="switchTab('tables', this)"><i class="fas fa-list-ol"></i> Tabele</button>
        <button class="menu-btn" onclick="switchTab('news', this)"><i class="fas fa-newspaper"></i> Aktualności</button>
        <button class="menu-btn" onclick="switchTab('teams', this)"><i class="fas fa-users"></i> Drużyny</button>
        <button class="menu-btn" onclick="switchTab('settings', this)"><i class="fas fa-cog"></i> Ustawienia</button>
        <div style="margin-top:auto">
            <button class="btn btn-danger" onclick="logout()" style="width:100%">Wyloguj</button>
        </div>
    </nav>

    <main class="main">

        <div id="tab-matches" class="section active">
            <div class="header-row">
                <h2>Lista Meczów</h2>
                <button class="btn btn-success" onclick="openMatchModal()"><i class="fas fa-plus"></i> Dodaj Mecz</button>
            </div>
            <div id="matchesContainer">Ładowanie...</div>
        </div>

        <div id="tab-tables" class="section">
            <div class="header-row"><h2>Tabele Grupowe i Strzelcy</h2></div>
            
            <div class="tables-grid" id="groupsContainer">
                </div>

            <div class="card" style="margin-top:20px;">
                <h3 style="color:var(--warning);">Top Strzelcy (Generalna)</h3>
                <table class="styled-table">
                    <thead><tr><th>#</th><th>Zawodnik</th><th>Drużyna</th><th>Gole</th></tr></thead>
                    <tbody id="topScorersBody"></tbody>
                </table>
            </div>
        </div>

        <div id="tab-news" class="section">
            <h2>Zarządzanie Newsami</h2>
            <div class="card">
                <input type="text" id="newsTitle" placeholder="Tytuł newsa">
                <textarea id="newsContent" rows="3" placeholder="Treść newsa..." style="margin-top:10px;"></textarea>
                <button class="btn btn-primary" style="margin-top:15px;" onclick="addNews()">Opublikuj</button>
            </div>
            <div id="newsContainer"></div>
        </div>

        <div id="tab-teams" class="section">
            <h2>Drużyny i Konta</h2>
            <div class="card">
                <h3>Lista Drużyn (Edytuj składy)</h3>
                <div id="teamsListContainer">Ładowanie...</div>
            </div>
            <div class="card" style="border-top: 3px solid var(--success);">
                <h3>Kreator Konta</h3>
                <div class="grid-form">
                    <div><label>Email</label><input type="email" id="accEmail"></div>
                    <div><label>Hasło</label><input type="password" id="accPass"></div>
                    <div><label>Nazwa</label><input type="text" id="accTeamName"></div>
                    <div><label>ID</label><input type="text" id="accTeamId" placeholder="TEAM_01"></div>
                </div>
                <button class="btn btn-success" onclick="createAccountAndTeam()" style="margin-top:20px; width:100%">Utwórz</button>
            </div>
        </div>

        <div id="tab-settings" class="section">
            <h2>Ustawienia</h2>
            <div class="card">
                <div style="display:flex; gap:10px;">
                    <input type="checkbox" id="lockSquads" onchange="toggleLock()" style="width:20px;">
                    <label for="lockSquads" style="margin-top:0;">Zablokuj edycję składów</label>
                </div>
            </div>
        </div>
    </main>
</div>

<div id="matchModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-header"><h3 id="matchModalTitle" style="margin:0; color:white;">Mecz</h3><button onclick="closeMatchModal()" style="background:none; border:none; color:white; font-size:1.5rem;">&times;</button></div>
        <div class="modal-body">
            <input type="hidden" id="editMatchId">
            <div class="grid-form">
                <div class="full-width"><label>Status</label><select id="mStatus" style="font-weight:bold; color:var(--accent);"><option value="planned">PLANOWANY</option><option value="live">NA ŻYWO</option><option value="finished">ZAKOŃCZONY</option></select></div>
                <div><label>Gospodarz</label><select id="mHome"></select></div>
                <div><label>Gość</label><select id="mAway"></select></div>
                <div><label>Data</label><input type="date" id="mDate"></div>
                <div><label>Godzina</label><input type="time" id="mTime"></div>
                <div class="full-width"><label>Grupa</label><select id="mGroup"><option value="A">Grupa A</option><option value="B">Grupa B</option><option value="C">Grupa C</option><option value="D">Grupa D</option><option value="faza_pucharowa">Pucharowa</option></select></div>
                
                <div style="border-top:1px solid #444; margin-top:10px; padding-top:10px;"><label style="color:var(--success)">Gole Gospodarze</label><input type="number" id="mHomeScore" value="0"></div>
                <div style="border-top:1px solid #444; margin-top:10px; padding-top:10px;"><label style="color:var(--success)">Gole Goście</label><input type="number" id="mAwayScore" value="0"></div>
            </div>
            <div style="margin-top:20px; background:rgba(0,0,0,0.2); padding:10px; border-radius:8px;">
                <label>Strzelcy (+1)</label>
                <div class="grid-form">
                    <div style="display:flex; gap:5px;"><select id="mHomePlayer"><option>--</option></select><button class="btn-success" onclick="addGoal('home')">+</button></div>
                    <div style="display:flex; gap:5px;"><select id="mAwayPlayer"><option>--</option></select><button class="btn-success" onclick="addGoal('away')">+</button></div>
                </div>
            </div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" onclick="closeMatchModal()">Anuluj</button><button class="btn btn-primary" onclick="saveMatch()">ZAPISZ</button></div>
    </div>
</div>

<div id="teamModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-header"><h3 style="margin:0; color:white;">Edycja Składu</h3><button onclick="closeTeamModal()" style="background:none; border:none; color:white; font-size:1.5rem;">&times;</button></div>
        <div class="modal-body">
            <input type="hidden" id="editTeamId">
            <input type="text" id="editTeamName" style="margin-bottom:10px;">
            <button class="btn btn-primary btn-sm" onclick="saveTeamName()">Zmień Nazwę</button>
            
            <h4 style="margin-top:20px; border-bottom:1px solid #444;">Zawodnicy</h4>
            <table class="styled-table"><tbody id="teamPlayersList"></tbody></table>
            
            <div style="margin-top:15px; display:flex; gap:10px;">
                <input type="number" id="newPlayerNum" placeholder="Nr" style="width:60px;">
                <input type="text" id="newPlayerName" placeholder="Nazwisko">
                <button class="btn btn-success" onclick="addNewPlayer()">Dodaj</button>
            </div>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary" onclick="closeTeamModal()">Zamknij</button></div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="admin.js"></script>
<script>
    function switchTab(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-'+id).classList.add('active');
        if(btn) btn.classList.add('active');
    }
</script>
</body>
</html>