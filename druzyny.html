<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Drużyna - Ładowanie...</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* ==================================
           GLOBALNE STYLE I TRYB JASNY
           ================================== */
        body { 
            font-family: 'Roboto', sans-serif; 
            margin: 0;
            padding: 20px 10px; 
            background: linear-gradient(135deg, #e0f2f7 0%, #bbdefb 100%); 
            color: #212121;
            display: flex; 
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background 0.5s ease, color 0.5s ease; /* Płynne przejście trybu */
        }

        /* NAGŁÓWEK (.header) */
        .header {
            width: 100%; max-width: 900px; margin-bottom: 30px; padding: 25px;
            background-color: #ffffff; border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25); border: 2px solid #64b5f6;
            display: flex; justify-content: space-between; align-items: center;
            transition: background-color 0.5s ease, box-shadow 0.5s ease, border-color 0.5s ease;
        }
        
        .header h1 {
            font-family: 'Montserrat', sans-serif; color: #1565c0; font-size: 3.2em;
            margin-bottom: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* LINKI LOGOWANIA (.login-links) */
        .login-links { display: flex; gap: 15px; }
        .login-links a {
            color: white; background-color: #1976d2; text-decoration: none;
            font-weight: bold; padding: 8px 12px; border-radius: 5px;
            transition: background-color 0.3s;
        }
        .login-links a:hover { background-color: #2196f3; }

        /* NAWIGACJA (NAV) */
        #main-nav {
            width: 100%; max-width: 900px; background-color: #1976d2;
            border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px; padding: 10px 0; display: flex;
            justify-content: center; flex-wrap: wrap; gap: 20px;
            transition: background-color 0.5s ease, box-shadow 0.5s ease;
        }
        #main-nav ul { list-style: none; margin: 0; padding: 0; display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        #main-nav a {
            color: #ffffff; text-decoration: none; font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 1.1em;
            padding: 8px 15px; border-radius: 8px; transition: background-color 0.3s ease, transform 0.2s ease;
        }
        #main-nav a:hover { background-color: #2196f3; transform: translateY(-2px); }

        /* KONTYNUACJA TREŚCI DRUŻYNY */
        .team-container {
            max-width: 900px; width: 100%; margin-bottom: 30px; padding: 25px;
            background: white; border-radius: 15px; 
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25); border: 2px solid #64b5f6;
            transition: background 0.5s ease, box-shadow 0.5s ease, border-color 0.5s ease;
        }

        /* Nagłówki sekcji (H1, H2) */
        #team-header { text-align: center; padding-bottom: 10px; border-bottom: 2px solid #64b5f6; margin-bottom: 25px; }
        #team-name { font-family: 'Montserrat', sans-serif; color: #1565c0; font-size: 3.0em; margin: 0; font-weight: 700; text-transform: uppercase; }
        #team-id-display { font-size: 1.1em; color: #6c757d; margin-top: 5px; }
        
        .section-header {
            font-family: 'Montserrat', sans-serif; font-size: 2.2em; color: #1565c0;
            margin-top: 30px; margin-bottom: 20px; padding-bottom: 5px;
            border-bottom: 2px solid #64b5f6; font-weight: 700;
        }
        .section-header i { color: #1565c0; margin-right: 10px; }
        
        /* Osiągnięcia */
        #achievements-list { list-style: none; padding: 0; display: flex; flex-wrap: wrap; gap: 15px; justify-content: flex-start; }
        .achievement-badge {
            background-color: #28a745; color: white; padding: 8px 15px; border-radius: 8px; 
            font-weight: 500; display: flex; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-size: 1em;
            transition: background-color 0.3s;
        }

        /* Tabela Zawodników */
        .player-table {
            width: 100%; border-collapse: collapse; text-align: left;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-radius: 10px; overflow: hidden;
        }
        .player-table th { background-color: #1976d2; color: white; padding: 15px; text-transform: uppercase; font-weight: 700; letter-spacing: 1px; }
        .player-table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; vertical-align: middle; }
        .player-table tbody tr:nth-child(even) { background-color: #f8f9fa; }
        .player-table tbody tr:hover { background-color: #e3f2fd; }
        .player-number { font-size: 1.2em; font-weight: 700; color: #dc3545; text-align: center; width: 70px; flex-shrink: 0; }
        
        /* Lista Mobilna */
        #players-list-mobile { display: none; }
        .player-item-wrapper {
            display: flex; align-items: center; padding: 12px 10px;
            border-bottom: 1px dashed #64b5f6; background-color: white;
            transition: background-color 0.3s;
        }
        .player-item-wrapper:nth-child(even) { background-color: #f8f9fa; }
        
        /* FOOTER */
        .footer {
            width: 100%; max-width: 900px; text-align: center; padding: 15px 0; margin-top: 30px;
            color: #1565c0; border-top: 1px solid #64b5f6; display: flex;
            justify-content: space-between; align-items: center;
            transition: color 0.5s ease, border-top-color 0.5s ease;
        }
        .social-media-links a { color: #1565c0; font-size: 1.5em; margin-left: 15px; transition: color 0.3s; }
        .social-media-links a:hover { color: #007bff; }


        /* ==================================
           STYLISTYKA TRYBU CIEMNEGO
           ================================== */

        body.dark-mode {
            background: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
            color: #e0e0e0;
        }

        body.dark-mode .header {
            background-color: #263238;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            border-color: #37474f;
        }
        body.dark-mode .header h1 {
            color: #90caf9;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        body.dark-mode .login-links a {
            background-color: #0d47a1;
        }
        body.dark-mode .login-links a:hover {
            background-color: #1565c0;
        }
        
        body.dark-mode #main-nav {
            background-color: #0d47a1;
        }
        body.dark-mode #main-nav a:hover {
            background-color: #1565c0;
        }
        
        body.dark-mode .team-container {
            background: #263238;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            border-color: #37474f;
        }

        /* Nagłówki sekcji w trybie ciemnym */
        body.dark-mode #team-header { border-bottom: 2px solid #37474f; }
        body.dark-mode #team-name { color: #90caf9; }
        body.dark-mode #team-id-display { color: #bdbdbd; }
        
        body.dark-mode .section-header {
            color: #90caf9;
            border-bottom: 2px solid #37474f;
        }
        body.dark-mode .section-header i { color: #90caf9; }
        
        /* Osiągnięcia w trybie ciemnym */
        body.dark-mode .achievement-badge {
            background-color: #1b5e20; /* Ciemniejsza zieleń */
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* Tabela w trybie ciemnym */
        body.dark-mode .player-table th { background-color: #0d47a1; }
        body.dark-mode .player-table td { border-bottom: 1px solid #424242; }
        body.dark-mode .player-table tbody tr { background-color: #263238; }
        body.dark-mode .player-table tbody tr:nth-child(even) { background-color: #37474f; }
        body.dark-mode .player-table tbody tr:hover { background-color: #1e88e5; }
        body.dark-mode .player-name, body.dark-mode .player-number { color: #e0e0e0; }
        body.dark-mode .player-number { color: #ffab91; } /* Pomarańczowy akcent */

        /* Lista mobilna w trybie ciemnym */
        body.dark-mode .player-item-wrapper {
            background-color: #263238;
            border-bottom: 1px dashed #37474f;
        }
        body.dark-mode .player-item-wrapper:nth-child(even) { background-color: #37474f; }
        
        /* Stopka w trybie ciemnym */
        body.dark-mode .footer {
            color: #90caf9;
            border-top: 1px solid #37474f;
        }
        body.dark-mode .social-media-links a { color: #90caf9; }
        body.dark-mode .social-media-links a:hover { color: #bbdefb; }

        /* Przełącznik trybu ciemnego */
        #theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #1976d2;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s, transform 0.2s;
            z-index: 1000;
        }
        #theme-toggle:hover {
            background-color: #2196f3;
            transform: scale(1.05);
        }
        body.dark-mode #theme-toggle {
            background-color: #0d47a1;
        }
        body.dark-mode #theme-toggle:hover {
            background-color: #1565c0;
        }

        /* Sekcja Responsive */
        @media (max-width: 768px) {
            /* (Pozostałe style responsywne bez zmian) */
            .header { flex-direction: column; align-items: center; padding: 15px; }
            .header h1 { font-size: 2.5em; }
            .login-links { margin-top: 15px; gap: 10px; }
            .login-links a { font-size: 0; padding: 10px; }
            .login-links a i { font-size: 1.4rem; margin: 0; }
            #main-nav { padding: 8px 0; }
            #main-nav ul { gap: 10px; }
            #main-nav a { font-size: 1em; padding: 6px 10px; }
            .team-container { padding: 15px; border-radius: 0; box-shadow: none; border: none; }
            #team-name { font-size: 2.2em; }
            .section-header { font-size: 1.8em; margin-top: 25px; }
            .player-table { display: none; }
            #players-list-mobile { display: block; }
            .player-number { width: 50px; font-size: 1.1em; }
            .footer { flex-direction: column; margin-top: 15px; }
            .social-media-links { margin-top: 10px; }
        }
    </style>
</head>
<body>
    
    <div class="header">
        <h1>Puchar Gwiazd</h1>
        <div class="login-links">
            <a href="login_kapitana.html"><i class="fas fa-user-shield"></i> Kapitan</a>
            <a href="admin.html"><i class="fas fa-user-cog"></i> Admin</a>
        </div>
        <div id="current-time" style="display: none;"></div>
    </div>

    <nav id="main-nav">
        <ul>
            <li><a href="index.html">Strona Główna</a></li>
            <li><a href="druzyny.html">Drużyny</a></li>
            <li><a href="regulamin.html">Regulamin</a></li>
            <li><a href="tabela.html">Tabele Grup</a></li>
            <li><a href="onas.html">O Nas</a></li>
            <li><a href="pusta-strona.html">Pusta Strona</a></li>
        </ul>
    </nav>
    
    <div class="team-container">
        <div id="team-header">
            <h1 id="team-name">ŁADOWANIE NAZWY DRUŻYNY...</h1>
            <p id="team-id-display">ID: (Pobieranie danych)</p>
        </div>

        <h2 class="section-header"><i class="fas fa-trophy"></i> Osiągnięcia</h2>
        <ul id="achievements-list">
            <li>Ładowanie osiągnięć...</li>
        </ul>

        <h2 class="section-header"><i class="fas fa-users"></i> Skład Drużyny</h2>
        <div class="player-table-wrapper">
            
            <table class="player-table">
                <thead>
                    <tr>
                        <th style="width: 10%;">Nr</th>
                        <th style="width: 90%;">Imię i Nazwisko</th>
                    </tr>
                </thead>
                <tbody id="players-list-pc">
                    <tr><td colspan="2">Ładowanie składu...</td></tr>
                </tbody>
            </table>
            
            <ul id="players-list-mobile">
                <li class="player-item-wrapper"><span class="player-name">Ładowanie składu...</span></li>
            </ul>
        </div>

    </div>
    
    <div class="footer">
        <p>© 2025 Puchar Gwiazd. Wszystkie prawa zastrzeżone.</p>
        <div class="social-media-links">
            <a href="https://www.tiktok.com/@puchar.gwiazd" target="_blank"><i class="fab fa-tiktok"></i></a>
            <a href="https://www.instagram.com/puchargwiazd/" target="_blank"><i class="fab fa-instagram"></i></a>
        </div>
    </div>
    
    <button id="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

<script>
    // ===================================
    // FUNKCJONALNOŚĆ TRYBU CIEMNEGO
    // ===================================
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;
    
    function setDarkMode(isDark) {
        if (isDark) {
            body.classList.add('dark-mode');
            themeToggle.querySelector('i').className = 'fas fa-sun';
            localStorage.setItem('darkMode', 'enabled');
        } else {
            body.classList.remove('dark-mode');
            themeToggle.querySelector('i').className = 'fas fa-moon';
            localStorage.setItem('darkMode', 'disabled');
        }
    }
    
    // Sprawdzenie zapisanego stanu przy ładowaniu strony
    const savedMode = localStorage.getItem('darkMode');
    if (savedMode === 'enabled' || (!savedMode && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        setDarkMode(true);
    } else {
        setDarkMode(false);
    }

    // Obsługa kliknięcia przycisku
    themeToggle.addEventListener('click', () => {
        const isDark = body.classList.contains('dark-mode');
        setDarkMode(!isDark);
    });

    // ===================================
    // FUNKCJONALNOŚĆ FIREBASE
    // ===================================
    
    const firebaseConfig = {
        apiKey: "AIzaSyC6r04aG6T5EYqJ4OClraYU5Jr34ffONwo",
        authDomain: "puchargwiazd-bdaa4.firebaseapp.com",
        databaseURL: "https://puchargwiazd-bdaa4-default-rtdb.europe-west1.firebasedatabase.app", 
        projectId: "puchargwiazd-bdaa4",
        storageBucket: "puchargwiazd-bdaa4.firebasestorage.app",
        messagingSenderId: "890734185883",
        appId: "1:890734185883:web:4868b8bbf66c4bc7dfe53e"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const TEAM_BASE_PATH = "teams/teams/";

    function getTeamIdFromUrl() {
        const params = new URLSearchParams(window.location.search);
        let teamId = params.get('id');
        return teamId ? teamId.replace(/\s+/g, '') : null;
    }

    function loadTeamDetails() {
        const teamId = getTeamIdFromUrl();
        const teamNameDisplay = document.getElementById("team-name");
        const teamIdDisplay = document.getElementById("team-id-display");
        const playersListPC = document.getElementById("players-list-pc");
        const playersListMobile = document.getElementById("players-list-mobile");
        const achievementsList = document.getElementById("achievements-list");
        const pageTitle = document.getElementById("page-title");

        if (!teamId) {
            teamNameDisplay.textContent = "Błąd: Brak ID drużyny";
            teamIdDisplay.textContent = "Sprawdź poprawność linku.";
            playersListPC.innerHTML = '<tr><td colspan="2">Brak danych.</td></tr>';
            playersListMobile.innerHTML = '<li class="player-item-wrapper"><span class="player-name">Brak danych.</span></li>';
            return;
        }
        
        // Ustawienie wstępnej nazwy
        teamNameDisplay.textContent = teamId.toUpperCase();
        teamIdDisplay.textContent = `ID: ${teamId}`;
        pageTitle.textContent = `Drużyna - ${teamId}`;

        // Nasłuchiwanie zmian w bazie danych dla wybranej drużyny
        db.ref(TEAM_BASE_PATH + teamId).on('value', snapshot => {
            const teamData = snapshot.val();

            if (!teamData) {
                teamNameDisplay.textContent = "DRUŻYNA NIE ZNALEZIONA";
                teamIdDisplay.textContent = `ID: ${teamId}`;
                playersListPC.innerHTML = '<tr><td colspan="2">Brak danych o drużynie.</td></tr>';
                playersListMobile.innerHTML = '<li class="player-item-wrapper"><span class="player-name">Brak danych o drużynie.</span></li>';
                achievementsList.innerHTML = '<li>Brak osiągnięć.</li>';
                return;
            }

            // 1. RENDEROWANIE SKŁADU
            playersListPC.innerHTML = '';
            playersListMobile.innerHTML = '';
            const players = teamData.players;
            
            if (players) {
                const sortedPlayers = Object.values(players)
                    .sort((a, b) => (a.number || 999) - (b.number || 999));

                sortedPlayers.forEach(player => {
                    const playerNumber = player.number !== undefined && player.number !== null ? player.number : '—'; 
                    
                    // WERSJA PC (Tabela)
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td class="player-number">${playerNumber}</td>
                        <td>${player.name}</td>
                    `;
                    playersListPC.appendChild(row);
                    
                    // WERSJA MOBILNA (Lista)
                    const listItem = document.createElement("li");
                    listItem.classList.add('player-item-wrapper');
                    listItem.innerHTML = `
                        <span class="player-number">${playerNumber}</span>
                        <span class="player-name">${player.name}</span>
                    `;
                    playersListMobile.appendChild(listItem);
                });
            } else {
                playersListPC.innerHTML = '<tr><td colspan="2">Brak zawodników w składzie.</td></tr>';
                playersListMobile.innerHTML = '<li class="player-item-wrapper"><span class="player-name">Brak zawodników w składzie.</span></li>';
            }

            // 2. RENDEROWANIE OSIĄGNIĘĆ
            achievementsList.innerHTML = '';
            const achievements = teamData.achievements;

            if (achievements) {
                const fragment = document.createDocumentFragment();
                Object.values(achievements).forEach(achievementText => {
                    const listItem = document.createElement("li");
                    listItem.classList.add('achievement-badge');
                    listItem.innerHTML = `<i class="fas fa-award"></i> ${achievementText}`;
                    fragment.appendChild(listItem);
                });
                achievementsList.appendChild(fragment);

            } else {
                achievementsList.innerHTML = '<li>Brak osiągnięć.</li>';
            }
        });
    }

    document.addEventListener('DOMContentLoaded', loadTeamDetails);
</script>
</body>
</html>
